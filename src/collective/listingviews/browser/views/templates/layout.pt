<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  lang="en"
  metal:use-macro="context/main_template/macros/master"
  i18n:domain="collective.listingviews">

  <body>
    <metal:core fill-slot="content-core">
      <tal:core-macro metal:define-macro="content-core">

        <div class="listingviews" tal:define="adapter context/@@listing_view_adapter">
          <div class="noimages" tal:condition="python: adapter.number_of_items == 0">
              <p class="discreet" i18n:translate="label_no_listing">
                  Please choose your view in listing settings.
              </p>
          </div>
          <div class="listing-collection-view" 
            tal:define="class_name python: adapter.listing_style_class;
                        fields python: adapter.retrieve_items;
                        batch python: adapter.retrieve_listing_items" 
            tal:condition="python: adapter.number_of_items > 0" 
            tal:attributes="class string:${class_name} listing-collection-view">

              <div class="listing-item-fields">
                <dl class="item-fields">
                  <tal:fields tal:repeat="field fields">
                    <tal:def tal:define="fieldclass string:listing-field field-${field/css_class};
                      customfieldclass string:listing-field ${field/css_class}"> 
                      <tal:listingfield tal:condition="not:field/is_custom">
                        <dt tal:content="string: ${field/title}" tal:attributes="class fieldclass"></dt>
                        <dd tal:content="structure field/value" tal:attributes="class fieldclass"></dd>
                      </tal:listingfield>
                      <tal:listingfield tal:condition="field/is_custom">
                        <dt tal:content="string: ${field/title}" tal:attributes="class customfieldclass"></dt>
                        <dd tal:content="structure field/value" tal:attributes="class customfieldclass"></dd>
                      </tal:listingfield>
                    </tal:def>
                  </tal:fields>
                </dl>
              </div>
            
              <ul class="listing-items-view">
                  <li class="listing-item" tal:repeat="item_object batch">
                      <dl class="listing-fields">
                          <tal:fields tal:repeat="field item_object">
                              <tal:def tal:define="fieldclass string:listing-field field-${field/css_class};
                                customfieldclass string:listing-field ${field/css_class}"> 
                                <tal:listingfield tal:condition="not:field/is_custom">
                                  <dt tal:content="string: ${field/title}" tal:attributes="class fieldclass"></dt>
                                  <dd tal:content="structure field/value" tal:attributes="class fieldclass"></dd>
                                </tal:listingfield>
                                <tal:listingfield tal:condition="field/is_custom">
                                  <dt tal:content="string: ${field/title}" tal:attributes="class customfieldclass"></dt>
                                  <dd tal:content="structure field/value" tal:attributes="class customfieldclass"></dd>
                                </tal:listingfield>
                              </tal:def>
                          </tal:fields>
                      </dl>
                  </li>
              </ul>
              <div class="listing-navigation" tal:condition="adapter/listing_view_batch_size">
                <div metal:use-macro="view/context/batch_macros/macros/navigation"> 
                  Navigation
                </div>
              </div>
            </div>
          </div>
      </tal:core-macro>
    </metal:core>
  </body>
</html>
