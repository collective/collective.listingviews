<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  lang="en"
  metal:use-macro="context/main_template/macros/master"
  i18n:domain="collective.listingviews">

  <body >
  
    <metal:core fill-slot="content-core">
          <!-- we adapt our local context and request and our setting to determine what to list -->

        <div class="listingviews" tal:define="adapter nocall:context/@@listing_view_adapter;
            batch folderContents | adapter/retrieve_listing_items;"
             
          >
          <div class="listing-collection-view"
            tal:define="class_name python: adapter.listing_style_class;
                        fields python: adapter.retrieve_items;"
            tal:attributes="class string:${class_name} listing-collection-view">

              <div class="listing-item-fields">
                <dl class="item-fields">
                  <tal:fields tal:repeat="field fields">
                    <tal:def tal:define="fieldclass string:listing-field field-${field/css_class};
                      customfieldclass string:listing-field ${field/css_class}"> 
                      <tal:listingfield tal:condition="not:field/is_custom">
                        <dt tal:content="string: ${field/title}" tal:attributes="class fieldclass"></dt>
                        <dd tal:content="structure field/value" tal:attributes="class fieldclass"></dd>
                      </tal:listingfield>
                      <tal:listingfield tal:condition="field/is_custom">
                        <dt tal:content="string: ${field/title}" tal:attributes="class customfieldclass"></dt>
                        <dd tal:content="structure field/value" tal:attributes="class customfieldclass"></dd>
                      </tal:listingfield>
                    </tal:def>
                  </tal:fields>
                </dl>
              </div>
              <tal:core-macro metal:define-macro="content-core"
                              tal:define="adapter adapter | nocall:context/@@listing_view_adapter;
                              batch folderContents | adapter/retrieve_listing_items;">

              <ul class="listing-items-view">
                  <li class="listing-item" tal:repeat="item_object batch">
                      <dl class="listing-fields">
                          <tal:fields tal:repeat="field python:adapter.assemble_listing_information(item_object)">
                              <tal:def tal:define="fieldclass string:listing-field field-${field/css_class};
                                customfieldclass string:listing-field ${field/css_class}"> 
                                <tal:listingfield tal:condition="not:field/is_custom">
                                  <dt tal:content="string: ${field/title}" tal:attributes="class fieldclass"></dt>
                                  <dd tal:content="structure field/value" tal:attributes="class fieldclass"></dd>
                                </tal:listingfield>
                                <tal:listingfield tal:condition="field/is_custom">
                                  <dt tal:content="string: ${field/title}" tal:attributes="class customfieldclass"></dt>
                                  <dd tal:content="structure field/value" tal:attributes="class customfieldclass"></dd>
                                </tal:listingfield>
                              </tal:def>
                          </tal:fields>
                      </dl>
                  </li>
              </ul>
              <div class="listing-navigation" tal:condition="adapter/listing_view_batch_size">
                <div metal:use-macro="view/context/batch_macros/macros/navigation"> 
                  Navigation
                </div>
              </div>
              </tal:core-macro>
        </div>
      </div>
    </metal:core>
  </body>
</html>
